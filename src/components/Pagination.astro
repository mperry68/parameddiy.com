---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

const getPageUrl = (page: number) => {
  if (page === 1) return baseUrl;
  return `${baseUrl}${baseUrl.includes('?') ? '&' : '?'}page=${page}`;
};

const pagesToShow: number[] = [];
for (let i = 1; i <= totalPages; i++) {
  if (
    i === 1 ||
    i === totalPages ||
    (i >= currentPage - 1 && i <= currentPage + 1) ||
    i === currentPage - 2 ||
    i === currentPage + 2
  ) {
    pagesToShow.push(i);
  }
}
---

{totalPages > 1 && (
  <nav class="pagination" aria-label="Pagination">
    <div class="pagination-container">
      {currentPage > 1 && (
        <a href={getPageUrl(currentPage - 1)} class="pagination-link pagination-prev">
          ← Previous
        </a>
      )}
      <div class="pagination-pages">
        {pagesToShow.map((page, index) => {
          const prevPage = pagesToShow[index - 1];
          const showEllipsis = prevPage && page - prevPage > 1;
          
          return (
            <>
              {showEllipsis && <span class="pagination-ellipsis">...</span>}
              {page >= currentPage - 1 && page <= currentPage + 1 || page === 1 || page === totalPages ? (
                <a
                  href={getPageUrl(page)}
                  class={`pagination-link ${page === currentPage ? 'pagination-active' : ''}`}
                  aria-current={page === currentPage ? 'page' : undefined}
                >
                  {page}
                </a>
              ) : (
                <span class="pagination-ellipsis">...</span>
              )}
            </>
          );
        })}
      </div>
      {currentPage < totalPages && (
        <a href={getPageUrl(currentPage + 1)} class="pagination-link pagination-next">
          Next →
        </a>
      )}
    </div>
  </nav>
)}

<style>
  .pagination {
    margin: 3rem 0;
  }

  .pagination-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .pagination-pages {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .pagination-link {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 2.5rem;
    height: 2.5rem;
    padding: 0 0.75rem;
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid rgba(6, 182, 212, 0.3);
    border-radius: 8px;
    color: #cbd5e1;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
  }

  .pagination-link:hover {
    background: rgba(30, 41, 59, 0.8);
    border-color: rgba(6, 182, 212, 0.5);
    text-decoration: none;
    transform: translateY(-1px);
  }

  .pagination-active {
    background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
    border-color: #06b6d4;
    color: #fff;
    box-shadow: 0 4px 15px rgba(6, 182, 212, 0.3);
  }

  .pagination-active:hover {
    background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);
    border-color: #06b6d4;
    box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4);
  }

  .pagination-ellipsis {
    padding: 0 0.5rem;
    color: #64748b;
  }

  .pagination-prev,
  .pagination-next {
    font-weight: 600;
  }
</style>
